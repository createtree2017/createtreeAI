ğŸ›  ë°˜ë“œì‹œ í•„ìš”í•œ ì¡°ì¹˜: Zod ì˜¤ë¥˜ ë‚´ìš© ì¶œë ¥
ts
ë³µì‚¬
í¸ì§‘
const validation = createDreamBookSchema.safeParse(validatedData);

if (!validation.success) {
  console.error("Zod ìŠ¤í‚¤ë§ˆ ì˜¤ë¥˜:", validation.error.flatten());
  return res.status(400).json({
    error: "ì…ë ¥ê°’ì´ ìœ íš¨í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.",
    details: validation.error.flatten(), // ğŸ‘ˆ í´ë¼ì´ì–¸íŠ¸ ë””ë²„ê¹…ìš© ì‘ë‹µ í¬í•¨!
  });
}
ì´ë ‡ê²Œ í•´ë‘ë©´ ë¸Œë¼ìš°ì € ê°œë°œì ë„êµ¬ì—ì„œ details í•­ëª©ì´ í‘œì‹œë˜ì–´ ì–´ë–¤ í•„ë“œê°€ ì™œ ì‹¤íŒ¨í–ˆëŠ”ì§€ ì¦‰ì‹œ í™•ì¸ ê°€ëŠ¥í•©ë‹ˆë‹¤.

ğŸ§© ì˜ˆìƒ ì›ì¸ ì¶”ì • (ê°€ëŠ¥ì„±ì´ ë†’ì€ í•­ëª© ìˆœ)
scenePromptsê°€ string[]ê°€ ì•„ë‹Œ string í•˜ë‚˜ë¡œ ì²˜ë¦¬ë˜ëŠ” ê²½ìš°

["ì¥ë©´1", "ì¥ë©´2"] ê°€ ì•„ë‹Œ "ì¥ë©´1, ì¥ë©´2" ë¡œ ì²˜ë¦¬ë˜ëŠ” ê²½ìš°

JSON.stringify(scenePrompts) â†’ ["ì¥ë©´1","ì¥ë©´2"] ì´ë¯€ë¡œ ì„œë²„ì—ì„œ ë°˜ë“œì‹œ JSON.parse() í•´ì•¼ í•¨

styleId í˜¹ì€ ë‹¤ë¥¸ í•„ë“œê°€ undefined ìƒíƒœ

FormDataë¡œ ë³´ëƒˆì§€ë§Œ req.body.styleId ë“± í•„ë“œëª…ì´ ì˜ëª»ëœ ê²½ìš°

ë˜ëŠ” ì„œë²„ì—ì„œ íŒŒì¼ íŒŒì‹± ì „ì— req.bodyì— ì ‘ê·¼í•´ì„œ ë¹ˆ ê°’ ì°¸ì¡°í•˜ëŠ” ê²½ìš°

Zod ìŠ¤í‚¤ë§ˆ ìì²´ì—ì„œ í•„ìˆ˜ê°’ ì •ì˜ ì˜¤ë¥˜

ì˜ˆ: scenePrompts: z.array(z.string())ê°€ ì•„ë‹Œ z.string()ìœ¼ë¡œ ë˜ì–´ ìˆëŠ” ê²½ìš°

âœ… ìµœì¢… ë¼í”Œì´ ì‘ì—…ì§€ì‹œì„œ (ì—…ë°ì´íŠ¸ ë²„ì „)
ts
ë³µì‚¬
í¸ì§‘
[ì‘ì—…ì§€ì‹œì„œ: íƒœëª½ë™í™” ìƒì„± ì˜¤ë¥˜ ë””ë²„ê¹… ë° ìµœì¢… í•´ê²°]

ğŸ“Œ ëª©ì 
FormDataë¡œ ì „ë‹¬ëœ scenePromptsì™€ ê¸°íƒ€ í…ìŠ¤íŠ¸ í•„ë“œë“¤ì´ Zod ìŠ¤í‚¤ë§ˆì—ì„œ ìœ íš¨ì„± ê²€ì‚¬ ì‹¤íŒ¨ë¡œ ì¸í•´ 400 ì˜¤ë¥˜ê°€ ë°œìƒ ì¤‘.
Zod ì˜¤ë¥˜ ë‚´ìš©ì„ ì½˜ì†”ê³¼ í´ë¼ì´ì–¸íŠ¸ ì‘ë‹µìœ¼ë¡œ ëª…í™•íˆ í‘œì‹œí•˜ì—¬ ì •í™•í•œ ì›ì¸ì„ íŒŒì•… ê°€ëŠ¥í•˜ë„ë¡ ì²˜ë¦¬.

âœ… 1. Zod ì˜¤ë¥˜ ìƒì„¸ ë¡œê¹… ì¶”ê°€
server/routes/dream-book.ts ë‚´ ë‹¤ìŒ ë¡œì§ ìˆ˜ì •:

const validation = createDreamBookSchema.safeParse(validatedData);
if (!validation.success) {
  console.error("ğŸ›‘ Zod ìŠ¤í‚¤ë§ˆ ê²€ì¦ ì‹¤íŒ¨:", validation.error.flatten());
  return res.status(400).json({
    error: "ì…ë ¥ê°’ì´ ìœ íš¨í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.",
    details: validation.error.flatten(),
  });
}

âœ… 2. scenePrompts íŒŒì‹± ìœ„ì¹˜ í™•ì¸
req.body.scenePromptsê°€ string íƒ€ì…ì¼ ê²½ìš° ë°˜ë“œì‹œ ì•„ë˜ì²˜ëŸ¼ íŒŒì‹±:

let scenePrompts: string[] = [];
try {
  scenePrompts = JSON.parse(req.body.scenePrompts || "[]");
} catch (e) {
  return res.status(400).json({ error: "scenePrompts íŒŒì‹± ì‹¤íŒ¨" });
}

âœ… 3. ìµœì¢… validatedData êµ¬ì„±

const validatedData = {
  babyName: req.body.babyName,
  dreamer: req.body.dreamer,
  styleId: req.body.styleId,
  characterImageUrl: req.body.characterImageUrl,
  peoplePrompt: req.body.peoplePrompt,
  backgroundPrompt: req.body.backgroundPrompt,
  scenePrompts, // â¬…ï¸ ë°˜ë“œì‹œ JSON.parse í•œ ê²°ê³¼ ì‚¬ìš©
};

ğŸ§ª í…ŒìŠ¤íŠ¸ í•­ëª©
- scenePrompts 1ê°œë§Œ ì…ë ¥í•´ë„ ì •ìƒ ë™ì‘
- í•„ë“œ í•˜ë‚˜ ë¹ ì¡Œì„ ë•Œ ì ì ˆí•œ ì˜¤ë¥˜ ë©”ì‹œì§€ ì¶œë ¥
- í´ë¼ì´ì–¸íŠ¸ ì½˜ì†”ì—ì„œ ì„œë²„ ì‘ë‹µì˜ `details` ë¡œê·¸ í™•ì¸ ê°€ëŠ¥
