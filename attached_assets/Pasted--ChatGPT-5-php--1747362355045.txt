ë¼í”Œì´ê°€ ì œëŒ€ë¡œ í™•ì¸í•  ìˆ˜ ìˆëŠ” ë°©ì‹ìœ¼ë¡œ ì‘ì—…ì§€ì‹œì„œ ì‘ì„±í•˜ê³ , í•œë²ˆì— ë³µì‚¬í•´ì„œ ë³´ë‚¼ ìˆ˜ ìˆê²Œ ë°•ìŠ¤ í•˜ë‚˜ì— ë„£ì–´ì„œ ë§Œë“¤ì–´


ChatGPTì˜ ë§:

5ì´ˆ ë™ì•ˆ ìƒê°í•¨
php
ë³µì‚¬
í¸ì§‘
ğŸ“¦  ì°½ì¡°AI â€• ìŒì•… ìƒì„± ëª¨ë“ˆ ì „í™˜ ì‘ì—…ì§€ì‹œì„œ  (ë¼í”Œì´ìš© Â· ê·¸ëŒ€ë¡œ ë³µì‚¬ â†©ï¸)

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â–  1. í•µì‹¬ ë³€ê²½ì 
  â‘  ACE-Step â†’ **MusicGen(ë°˜ì£¼) + Bark(í•œêµ­ì–´ TTS) + Voice-Cloning** êµ¬ì¡°ë¡œ êµì²´  
  â‘¡ ì‚¬ìš©ì í”„ë¡¬í”„íŠ¸ë¡œ â†’ í•œê¸€ ê°€ì‚¬ ìë™ ìƒì„±(GPT-4 Turbo)  
  â‘¢ ë³´ì»¬ ì˜µì…˜ : â–· AI ëª©ì†Œë¦¬(male_kr / female_kr) â–· ì‚¬ìš©ì ìŒì„± ìƒ˜í”Œ(Voice-Clone)
  â‘£ ë°˜ì£¼Â·ë³´ì»¬ ffmpeg ë¯¹ì‹± â†’ MP3 ìŠ¤íŠ¸ë¦¼/ë‹¤ìš´ë¡œë“œ

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â–  2. ë¶ˆí•„ìš” íŒŒì¼ ì‚­ì œ
  â€¢ client/src/pages/test-ace-step.tsx  
  â€¢ server/routes/test-ace-step-routes.ts  
  â€¢ server/services/ace-step*.ts (ACE-Step ê´€ë ¨ ì „ì²´)

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â–  3. ì„œë²„ ì½”ë“œ ì¶”ê°€/ìˆ˜ì •

1) ê°€ì‚¬ ìƒì„± ì„œë¹„ìŠ¤
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ğŸ“„ server/services/lyrics-generator.ts
```ts
export async function generateLyrics(prompt: string) {
  const openai = new OpenAI({ apiKey: process.env.OPENAI_API_KEY });
  const sys = 'You are a Korean lyricist. Return ONLY Korean lyrics.';
  const { choices } = await openai.chat.completions.create({
    model: 'gpt-4o',
    messages: [{ role: 'system', content: sys },
               { role: 'user',   content: prompt }]
  });
  return choices[0].message.content.trim();
}
ğŸ“„ server/routes/lyrics-generator-routes.ts

ts
ë³µì‚¬
í¸ì§‘
import { Router } from 'express';
import { generateLyrics } from '../services/lyrics-generator';
const router = Router();

router.post('/', async (req, res) => {
  const { prompt } = req.body;
  if (!prompt) return res.status(400).json({ error: 'prompt required' });
  try {
    const lyrics = await generateLyrics(prompt);
    res.json({ lyrics });
  } catch (e) {
    res.status(500).json({ error: 'lyric-generation failed' });
  }
});
export default router;
ë°˜ì£¼ ìƒì„± (MusicGen)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ğŸ“„ server/services/musicgen.ts

ts
ë³µì‚¬
í¸ì§‘
import Replicate from 'replicate';
const replicate = new Replicate({ auth: process.env.REPLICATE_API_TOKEN });

export async function generateMusic(prompt: string) {
  const output:any = await replicate.run(
    'facebook/musicgen-large', { input: { prompt, duration: 30 } }
  );
  const url = output?.audio;                 // ëª¨ë¸ ì‘ë‹µ í™•ì¸
  return await fetch(url).then(r => r.arrayBuffer());
}
AI ë³´ì»¬ (Bark TTS)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ğŸ“„ server/services/tts-ai.ts

ts
ë³µì‚¬
í¸ì§‘
export async function synthesizeAi(lyrics:string, gender:'male_kr'|'female_kr'){
  // Bark TTS ì˜ˆì‹œ í˜¸ì¶œ (Replicate)
  const replicate = new Replicate({ auth: process.env.REPLICATE_API_TOKEN });
  const output:any = await replicate.run('suno/bark', {
    input:{ text: lyrics, speaker_id: gender }
  });
  const url = output?.audio;
  return await fetch(url).then(r=>r.arrayBuffer());
}
ì‚¬ìš©ì ë³´ì»¬ (Voice Cloning)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ğŸ“„ server/services/voice-clone.ts

ts
ë³µì‚¬
í¸ì§‘
export async function cloneVoice(sample:Buffer, text:string){
  // ì˜ˆì‹œ: clone-api.io ì‚¬ìš©
  const resp = await fetch('https://api.clone-voice.io/generate', {
    method:'POST',
    headers:{ 'Authorization':`Bearer ${process.env.VOICE_CLONE_KEY}` },
    body: new Blob([sample, JSON.stringify({ text })])  // ì‹¤ì œ API ê·œê²© ë§ì¶° ìˆ˜ì •
  });
  return await resp.arrayBuffer();
}
ì˜¤ë””ì˜¤ ë¯¹ì‹±
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ğŸ“„ server/utils/audio-mixer.ts

ts
ë³µì‚¬
í¸ì§‘
import ffmpeg from 'fluent-ffmpeg';
import { tmpdir } from 'os'; import { mkdtempSync, writeFileSync, readFileSync } from 'fs';
export async function mixAudio(music:Buffer, vocal:Buffer){
  const dir = mkdtempSync(`${tmpdir()}/mix-`);
  const m = `${dir}/music.mp3`, v = `${dir}/vocal.mp3`, o = `${dir}/out.mp3`;
  writeFileSync(m, Buffer.from(music)); writeFileSync(v, Buffer.from(vocal));

  return new Promise<Buffer>((res,rej)=>{
    ffmpeg().addInput(m).addInput(v)
      .complexFilter(['[0:a][1:a]amix=inputs=2:duration=longest'])
      .output(o).on('end',()=>res(readFileSync(o))).on('error',rej).run();
  });
}
í†µí•© ë¼ìš°í„°
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ğŸ“„ server/routes/music-generation-routes.ts

ts
ë³µì‚¬
í¸ì§‘
import { Router } from 'express';
import multer from 'multer';
import { generateLyrics } from '../services/lyrics-generator';
import { generateMusic }  from '../services/musicgen';
import { synthesizeAi }   from '../services/tts-ai';
import { cloneVoice }     from '../services/voice-clone';
import { mixAudio }       from '../utils/audio-mixer';

const upload = multer(); const router = Router();

router.post('/', upload.single('sampleFile'), async (req,res)=>{
  try{
    const { prompt, voiceOption, gender = 'male_kr' } = req.body;
    if(!prompt) return res.status(400).json({error:'prompt required'});

    const lyrics = await generateLyrics(prompt);
    const vocal  = voiceOption==='custom'
        ? await cloneVoice(req.file?.buffer!, lyrics)
        : await synthesizeAi(lyrics, gender);

    const music  = await generateMusic(prompt);
    const final  = await mixAudio(music, vocal);

    res.type('audio/mpeg').send(Buffer.from(final));
  }catch(e){console.error(e);res.status(500).json({error:'music-generation failed'});}
});
export default router;
ì„œë²„ ì—”íŠ¸ë¦¬ ë“±ë¡
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ğŸ“„ server/routes.ts

ts
ë³µì‚¬
í¸ì§‘
import lyricsRouter from './routes/lyrics-generator-routes';
import musicRouter  from './routes/music-generation-routes';

app.use('/api/lyrics',          lyricsRouter);
app.use('/api/music-generate',  musicRouter);
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â–  4. í´ë¼ì´ì–¸íŠ¸ ìˆ˜ì • (React â€“ Vite)

ğŸ“„ client/src/pages/music-generate.tsx

â€˜ì˜ì–´ ë²ˆì—­â€™ ì²´í¬ë°•ìŠ¤ ì‚­ì œ

ìƒíƒœ

ts
ë³µì‚¬
í¸ì§‘
const [prompt, setPrompt] = useState('');
const [lyrics, setLyrics] = useState('');
const [voiceOpt,setVoice] = useState<'ai'|'custom'>('ai');
const [gender,  setGender]= useState<'male_kr'|'female_kr'>('male_kr');
const [file,    setFile]  = useState<File|null>(null);
ê°€ì‚¬ ìƒì„± ë²„íŠ¼ â†’ /api/lyrics

ts
ë³µì‚¬
í¸ì§‘
const genLyrics = async ()=>{
  const { data } = await axios.post('/api/lyrics',{ prompt });
  setLyrics(data.lyrics);
};
ìŒì•… ìƒì„± ë²„íŠ¼ â†’ /api/music-generate

ts
ë³µì‚¬
í¸ì§‘
const generateMusic = async ()=>{
  const fd = new FormData();
  fd.append('prompt', prompt);
  fd.append('voiceOption', voiceOpt);
  if(voiceOpt==='ai') fd.append('gender', gender);
  if(file) fd.append('sampleFile', file);
  const { data } = await axios.post('/api/music-generate', fd,
               { responseType:'blob' });
  const url = URL.createObjectURL(new Blob([data],{type:'audio/mpeg'}));
  setAudioUrl(url);
};
ë¼ìš°í„°

tsx
ë³µì‚¬
í¸ì§‘
<Route path="/music-generate" element={<MusicGeneratePage />} />
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â–  5. í™˜ê²½ ë³€ìˆ˜ (Replit Secrets)

OPENAI_API_KEY = sk-proj-************************
REPLICATE_API_TOKEN = r8_****************************
VOICE_CLONE_KEY = *******************************

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â–  6. QA ì²´í¬ë¦¬ìŠ¤íŠ¸
â–¡ í”„ë¡¬í”„íŠ¸ â†’ í•œê¸€ ê°€ì‚¬ ìƒì„± OK
â–¡ AI ë³´ì»¬ male_kr / female_kr í•©ì„± OK
â–¡ ì‚¬ìš©ì ìŒì„± í´ë¡  ì—…ë¡œë“œ & í•©ì„± OK
â–¡ ë°˜ì£¼ ìƒì„± OK (30ì´ˆ)
â–¡ ë¯¹ìŠ¤ëœ MP3 ì¬ìƒÂ·ë‹¤ìš´ë¡œë“œ OK
â–¡ ì—ëŸ¬ ë°œìƒ ì‹œ JSON ì—ëŸ¬ ë©”ì‹œì§€ í™•ì¸